<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diego Crisafulli – Portfolio</title>
    <meta name="description" content="Portfolio of Diego Crisafulli – Software & ML Engineer. Cloud-native builder, full-stack developer, and simulation specialist.">
    <meta name="author" content="Diego Crisafulli">
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="https://diegocrisafu.github.io/diegoc55.github.io/">
    <meta name="theme-color" content="#2a4d69">
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Diego Crisafulli – Portfolio">
    <meta property="og:description" content="Cloud-native builder, full-stack developer, and simulation specialist.">
    <meta property="og:url" content="https://diegocrisafu.github.io/diegoc55.github.io/">
    <meta property="og:image" content="social-card.svg">
    <meta property="og:image:alt" content="Diego Crisafulli – Software & ML Engineer">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Diego Crisafulli – Portfolio">
    <meta name="twitter:description" content="Cloud-native builder, full-stack developer, and simulation specialist.">
    <meta name="twitter:image" content="social-card.svg">
    <!-- Performance hints for CDN deps -->
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="manifest" href="manifest.webmanifest">
    <!-- Link to the stylesheet for styling -->
    <link rel="stylesheet" href="style.css">
    <!-- Chat config: define window.CHAT_API_BASE before app code runs -->
    <script src="./chat-config.js"></script>
    <!-- Include React and React‑DOM from a CDN -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <!-- Include modern Babel Standalone (v7) to transpile JSX in-browser -->
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <!-- Surface runtime errors to the page for easier debugging on static hosting -->
        <script>
            window.addEventListener('error', function (e) {
                try {
                    var pre = document.createElement('pre');
                    pre.style.background = '#300';
                    pre.style.color = '#fff';
                    pre.style.padding = '8px';
                    pre.style.margin = '0';
                    pre.style.whiteSpace = 'pre-wrap';
                    pre.textContent = 'Error: ' + (e.error && e.error.stack || e.message || e.toString());
                    document.body.insertBefore(pre, document.body.firstChild);
                // Initialize modular assistant engine
                const assistantEngine = new window.AssistantEngine();
                    const dirRef = React.useRef({ x: 1, y: 0 });
                    const snakeRef = React.useRef([{ x: 8, y: 12 }]);
                    const appleRef = React.useRef({ x: 14, y: 12 });
                    const lastTimeRef = React.useRef(0);
                    const accRef = React.useRef(0);
                    const grid = 20; // 20x15 grid on 400x300 canvas
                    const stepMs = 120; // speed
                            const touchRef = React.useRef(null);

                    const reset = () => {
                        snakeRef.current = [{ x: 8, y: 12 }];
                        dirRef.current = { x: 1, y: 0 };
                        appleRef.current = { x: Math.floor(Math.random()*grid), y: Math.floor(Math.random()*15) };
                        setScore(0);
                    };

                    React.useEffect(() => {
                        reset();
                        const onKey = (e) => {
                            const k = e.key;
                            const d = dirRef.current;
                            if (k === ' ' || k === 'Spacebar') {
                                e.preventDefault();
                                if (!started) { setStarted(true); setGameOver(false); setRunning(true); return; }
                                setRunning((r) => !r);
                                return;
                            }
                            if (k === 'ArrowUp' || k === 'w') { if (d.y === 0) dirRef.current = { x: 0, y: -1 }; }
                            else if (k === 'ArrowDown' || k === 's') { if (d.y === 0) dirRef.current = { x: 0, y: 1 }; }
                            else if (k === 'ArrowLeft' || k === 'a') { if (d.x === 0) dirRef.current = { x: -1, y: 0 }; }
                            else if (k === 'ArrowRight' || k === 'd') { if (d.x === 0) dirRef.current = { x: 1, y: 0 }; }
                        };
                        window.addEventListener('keydown', onKey);
                                    const onVis = () => { if (document.hidden) setRunning(false); };
                                    document.addEventListener('visibilitychange', onVis);
                                    return () => {
                                        window.removeEventListener('keydown', onKey);
                                        document.removeEventListener('visibilitychange', onVis);
                                    };
                    }, []);

                    React.useEffect(() => {
                        let rafId;
                        const loop = (t) => {
                            if (!running) { rafId = requestAnimationFrame(loop); return; }
                            const canvas = canvasRef.current;
                            if (!canvas) return;
                            const ctx = canvas.getContext('2d');
                            const w = canvas.width, h = canvas.height;
                            // fixed timestep
                            const dt = t - (lastTimeRef.current || t);
                            lastTimeRef.current = t;
                            accRef.current += dt;
                            if (accRef.current >= stepMs) {
                                accRef.current = 0;
                                // advance
                                const snake = [...snakeRef.current];
                                const head = { x: snake[0].x + dirRef.current.x, y: snake[0].y + dirRef.current.y };
                                // wrap
                                head.x = (head.x + grid) % grid;
                                head.y = (head.y + 15) % 15;
                                // self collision
                                                if (snake.some((s) => s.x === head.x && s.y === head.y)) {
                                                    setRunning(false);
                                                    setStarted(false);
                                                    setGameOver(true);
                                                    // store best
                                                    setBest((b) => {
                                                        const nb = Math.max(b, score);
                function GameHero(){
                    // Snake game hero
                    // state hooks assumed declared earlier? Reconstruct minimal version
                    const canvasRef = React.useRef(null);
                    const [score, setScore] = React.useState(0);
                    const [best, setBest] = React.useState(()=> parseInt(localStorage.getItem('snakeBest')||'0',10)||0);
                    const [started, setStarted] = React.useState(false);
                    const [running, setRunning] = React.useState(false);
                    const [gameOver, setGameOver] = React.useState(false);
                    const dirRef = React.useRef({x:1,y:0});
                    const snakeRef = React.useRef([{x:5,y:5}]);
                    const appleRef = React.useRef({x:8,y:5});
                    const touchRef = React.useRef(null);
                    const grid = 20;
                    React.useEffect(()=>{
                        function onKey(e){
                            if(e.key===' '){ e.preventDefault(); if(!started){ setStarted(true); setRunning(true);} else setRunning(r=>!r); }
                            if(!running) return;
                            if(e.key==='ArrowUp' && dirRef.current.y!==1) dirRef.current={x:0,y:-1};
                            else if(e.key==='ArrowDown' && dirRef.current.y!==-1) dirRef.current={x:0,y:1};
                            else if(e.key==='ArrowLeft' && dirRef.current.x!==1) dirRef.current={x:-1,y:0};
                            else if(e.key==='ArrowRight' && dirRef.current.x!==-1) dirRef.current={x:1,y:0};
                        }
                        window.addEventListener('keydown', onKey);
                        return ()=>window.removeEventListener('keydown', onKey);
                    },[started,running]);
                    React.useEffect(()=>{
                        if(!running) return;
                        const ctx = canvasRef.current?.getContext('2d'); if(!ctx) return;
                        let rafId;
                        function loop(){
                            const snake = [...snakeRef.current];
                            const head={x:snake[0].x+dirRef.current.x,y:snake[0].y+dirRef.current.y};
                            const w=400,h=300;
                            if(head.x<0||head.y<0||head.x>=grid||head.y>=15||snake.some(s=>s.x===head.x&&s.y===head.y)){
                                setGameOver(true); setRunning(false);
                                setBest(b=>{ const nb=Math.max(b,score); localStorage.setItem('snakeBest',String(nb)); return nb; });
                            } else {
                                snake.unshift(head);
                                const apple=appleRef.current;
                                if(head.x===apple.x && head.y===apple.y){
                                    setScore(s=>s+1);
                                    let nx,ny; do { nx=Math.floor(Math.random()*grid); ny=Math.floor(Math.random()*15);} while(snake.some(s=>s.x===nx&&s.y===ny));
                                    appleRef.current={x:nx,y:ny};
                                } else { snake.pop(); }
                                snakeRef.current=snake;
                            }
                            ctx.fillStyle='#f5f7fa'; ctx.fillRect(0,0,w,h);
                            ctx.fillStyle='#4b86b4'; ctx.fillRect(appleRef.current.x*20+2, appleRef.current.y*20+2,16,16);
                            ctx.fillStyle='#2a4d69'; snakeRef.current.forEach((s,i)=>{ ctx.globalAlpha=Math.max(0.6,1-i*0.02); ctx.fillRect(s.x*20+2,s.y*20+2,16,16); }); ctx.globalAlpha=1;
                            rafId=requestAnimationFrame(loop);
                        }
                        rafId=requestAnimationFrame(loop);
                        return ()=>cancelAnimationFrame(rafId);
                    },[running,score]);
                    const handleStartPause=()=>{ if(!started){ setStarted(true); setRunning(true); } else setRunning(r=>!r); };
                    const handleRestart=()=>{ snakeRef.current=[{x:5,y:5}]; appleRef.current={x:8,y:5}; setScore(0); setGameOver(false); setStarted(true); setRunning(true); };
                    function onTouchStart(e){ const t=e.changedTouches[0]; touchRef.current={x:t.clientX,y:t.clientY}; }
                    function onTouchEnd(e){ if(!touchRef.current) return; const t=e.changedTouches[0]; const dx=t.clientX-touchRef.current.x, dy=t.clientY-touchRef.current.y; const adx=Math.abs(dx), ady=Math.abs(dy); const d=dirRef.current; if(Math.max(adx,ady)<18) return; if(adx>ady){ if(dx>0&&d.x===0) dirRef.current={x:1,y:0}; else if(dx<0&&d.x===0) dirRef.current={x:-1,y:0}; } else { if(dy>0&&d.y===0) dirRef.current={x:0,y:1}; else if(dy<0&&d.y===0) dirRef.current={x:0,y:-1}; } touchRef.current=null; }
                    return (
                        <div className="game-hero" onTouchStart={onTouchStart} onTouchEnd={onTouchEnd}>
                            <div className="game-scorebar"><span className="game-score">Score: {score}</span><span className="game-best">Best: {best}</span></div>
                            <canvas ref={canvasRef} width="400" height="300" className="game-canvas" aria-label="Snake game area"></canvas>
                            <div className="game-controls"><button className="button download‑btn" onClick={handleStartPause}>{started ? (running ? 'Pause':'Resume') : 'Play'}</button><button className="game-restart" onClick={handleRestart}>Restart</button></div>
                            <div className="game-help">Use arrow keys or WASD (or swipe) to move. Space toggles play/pause.</div>
                            {!started && !gameOver && <div className="game-overlay start">Press Space or Play to begin</div>}
                            {gameOver && <div className="game-overlay">Game Over — Score {score}. Press Restart.</div>}
                        </div>
                    );
                }
                }

                // Removed 2048 game for code simplification

                // Minesweeper Game — enhanced (presets, first-click safety, chording, timer, wave animation, best times, custom difficulty)
                function GameMinesweeper(){
                    const PRESETS = [
                        { id:'beginner', name:'Beginner', w:9, h:9, mines:10 },
                        { id:'intermediate', name:'Intermediate', w:16, h:16, mines:40 },
                        { id:'expert', name:'Expert', w:30, h:16, mines:99 },
                        { id:'insane', name:'Insane', w:24, h:24, mines:120 },
                    ];
                    const [preset, setPreset] = React.useState(PRESETS[1]);
                    const [grid, setGrid] = React.useState(()=> makeEmpty(preset.w, preset.h));
                    const [started, setStarted] = React.useState(false);
                    const [over, setOver] = React.useState(false);
                    const [won, setWon] = React.useState(false);
                    const [seconds, setSeconds] = React.useState(0);
                    const [remaining, setRemaining] = React.useState(preset.mines);
                    const [flagMode, setFlagMode] = React.useState(false);
                    const [recent, setRecent] = React.useState(()=> new Set());
                    const [origin, setOrigin] = React.useState(null);
                    const [bests, setBests] = React.useState(()=> { try { return JSON.parse(localStorage.getItem('mswBestTimes')||'{}'); } catch { return {}; } });
                    const [showCustom, setShowCustom] = React.useState(false);
                    const [cw, setCw] = React.useState(12);
                    const [ch, setCh] = React.useState(12);
                    const [cm, setCm] = React.useState(20);

                    React.useEffect(()=>{ if(!started || over || won) return; const id=setInterval(()=> setSeconds(s=>Math.min(999,s+1)),1000); return ()=>clearInterval(id); },[started,over,won]);

                    function fmtTime(s){ const m=Math.floor(s/60), r=s%60; return `${m}:${r.toString().padStart(2,'0')}`; }
                    function makeEmpty(w,h){ return Array.from({length:h},()=> Array.from({length:w},()=>({ r:0,m:false,f:false,v:false,x:false }))); }
                    function inb(x,y){ return y>=0 && y<grid.length && x>=0 && x<grid[0].length; }
                    function neighbors(x,y){ const d=[-1,0,1], out=[]; for(let dy of d) for(let dx of d){ if(dx||dy){ const nx=x+dx, ny=y+dy; if(inb(nx,ny)) out.push([nx,ny]); } } return out; }
                    function withMines(w,h,mines,avoid){ const g=makeEmpty(w,h); const forbid=new Set(avoid.map(([ax,ay])=>`${ax},${ay}`)); const cand=[]; for(let y=0;y<h;y++) for(let x=0;x<w;x++){ const k=`${x},${y}`; if(!forbid.has(k)) cand.push([x,y]); } for(let i=cand.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [cand[i],cand[j]]=[cand[j],cand[i]]; } for(const [x,y] of cand.slice(0,Math.min(mines,cand.length))) g[y][x].m=true; for(let y=0;y<h;y++) for(let x=0;x<w;x++) if(!g[y][x].m) g[y][x].r=neighbors(x,y).reduce((a,[nx,ny])=>a+(g[ny][nx].m?1:0),0); return g; }
                    function revealFlood(g,x,y){ const stack=[[x,y]]; while(stack.length){ const [cx,cy]=stack.pop(); const c=g[cy][cx]; if(c.v||c.f) continue; c.v=true; if(!c.m && c.r===0){ for(const n of neighbors(cx,cy)){ const [nx,ny]=n; const cc=g[ny][nx]; if(!cc.v && !cc.f) stack.push([nx,ny]); } } } }
                    function countFlagsAround(g,x,y){ let c=0; for(const [nx,ny] of neighbors(x,y)) if(g[ny][nx].f) c++; return c; }
                    function hiddenSafe(g){ let c=0; for(let y=0;y<g.length;y++) for(let x=0;x<g[0].length;x++){ const cell=g[y][x]; if(!cell.m && !cell.v) c++; } return c; }
                    function totalFlags(g){ let c=0; for(let y=0;y<g.length;y++) for(let x=0;x<g[0].length;x++) if(g[y][x].f) c++; return c; }
                    function reset(to=preset){ setPreset(to); setGrid(makeEmpty(to.w,to.h)); setStarted(false); setOver(false); setWon(false); setSeconds(0); setRemaining(to.mines); setFlagMode(false); setRecent(new Set()); setOrigin(null); }

                    function finishWin(g){ for(let y=0;y<g.length;y++) for(let x=0;x<g[0].length;x++){ if(g[y][x].m){ g[y][x].f=true; g[y][x].v=true; }} setGrid(g); setWon(true); setOver(true); setBests(prev=>{ const cur=prev[preset.id]; const better=(cur==null||seconds<cur)?seconds:cur; const out={...prev,[preset.id]:better}; try{localStorage.setItem('mswBestTimes',JSON.stringify(out));}catch{} return out; }); }

                    function handleReveal(x,y){ if(over||won) return; const prev=grid; let g=grid.map(r=>r.map(c=>({...c}))); if(!started){ const avoid=[[x,y],...neighbors(x,y)]; g=withMines(preset.w,preset.h,preset.mines,avoid); setStarted(true);} const cell=g[y][x]; if(cell.v||cell.f){ setGrid(g); return;} if(cell.m){ cell.x=true; cell.v=true; for(let yy=0;yy<g.length;yy++) for(let xx=0;xx<g[0].length;xx++) if(g[yy][xx].m) g[yy][xx].v=true; setGrid(g); setOver(true); return;} revealFlood(g,x,y); const keys=[]; for(let yy=0;yy<g.length;yy++) for(let xx=0;xx<g[0].length;xx++) if(!prev[yy][xx].v && g[yy][xx].v) keys.push(`${xx}-${yy}`); setGrid(g); setOrigin({x,y}); setRecent(new Set(keys)); setTimeout(()=> setRecent(new Set()),500); if(hiddenSafe(g)===0) finishWin(g); setRemaining(Math.max(0,preset.mines-totalFlags(g))); }
                    function handleToggleFlag(x,y){ if(over||won) return; if(!started) setStarted(true); const g=grid.map(r=>r.map(c=>({...c}))); const cell=g[y][x]; if(cell.v){ setGrid(g); return;} cell.f=!cell.f; setGrid(g); setRemaining(Math.max(0,preset.mines-totalFlags(g))); }
                    function handleChord(x,y){ if(over||won) return; const prev=grid; const g=grid.map(r=>r.map(c=>({...c}))); const cell=g[y][x]; if(!cell.v||cell.r<=0) return; if(countFlagsAround(g,x,y)!==cell.r) return; let exploded=false; for(const [nx,ny] of neighbors(x,y)){ const n=g[ny][nx]; if(n.v||n.f) continue; if(n.m){ n.x=true; n.v=true; exploded=true;} else revealFlood(g,nx,ny);} if(exploded){ for(let yy=0;yy<g.length;yy++) for(let xx=0;xx<g[0].length;xx++) if(g[yy][xx].m) g[yy][xx].v=true; setGrid(g); setOver(true); return;} const keys=[]; for(let yy=0;yy<g.length;yy++) for(let xx=0;xx<g[0].length;xx++) if(!prev[yy][xx].v && g[yy][xx].v) keys.push(`${xx}-${yy}`); setGrid(g); setOrigin({x,y}); setRecent(new Set(keys)); setTimeout(()=> setRecent(new Set()),500); if(hiddenSafe(g)===0) finishWin(g); setRemaining(Math.max(0,preset.mines-totalFlags(g))); }
                    function onCellClick(e,x,y){ e.preventDefault(); if(flagMode || e.shiftKey||e.ctrlKey||e.metaKey) handleToggleFlag(x,y); else handleReveal(x,y); }
                    function onCellRight(e,x,y){ e.preventDefault(); handleToggleFlag(x,y); }
                    function onCellDouble(e,x,y){ e.preventDefault(); handleChord(x,y); }
                    React.useEffect(()=>{ setRemaining(Math.max(0,preset.mines-totalFlags(grid))); },[grid,preset]);

                    return (<div className="msw"> <div className="msw-top"> <div className="msw-counters"> <span className="msw-count">Mines: {remaining}</span> <span className="msw-count">Time: {seconds.toString().padStart(3,'0')}</span> <span className="msw-count">Best: {bests[preset.id]!=null?fmtTime(bests[preset.id]):'—'}</span> </div> <div className="msw-controls"> <div className="msw-diffs"> {PRESETS.map(p=> <button key={p.id} className={`msw-btn ${p.id===preset.id?'active':''}`} onClick={()=> reset(p)}>{p.name}</button>)} <button className={`msw-btn ${String(preset.id||'').startsWith('custom')?'active':''}`} onClick={()=> setShowCustom(x=>!x)}>Custom…</button> </div> <button className="msw-btn" onClick={()=> reset(preset)}>New Game</button> <button className={`msw-btn ${flagMode?'active':''}`} onClick={()=> setFlagMode(f=>!f)} title="Touch mode: place flags">Flag Mode</button> </div> {showCustom && <div className="msw-custom"> <label>W <input type="number" min="5" max="50" value={cw} onChange={e=> setCw(Math.max(5,Math.min(50,parseInt(e.target.value||'0',10))))}/></label> <label>H <input type="number" min="5" max="50" value={ch} onChange={e=> setCh(Math.max(5,Math.min(50,parseInt(e.target.value||'0',10))))}/></label> <label>M <input type="number" min="1" max={cw*ch-9} value={cm} onChange={e=> setCm(Math.max(1,Math.min(cw*ch-9,parseInt(e.target.value||'0',10))))}/></label> <button className="msw-btn" onClick={()=> { const w=cw,h=ch,mines=Math.min(cm,w*h-9); reset({id:`custom:${w}x${h}:${mines}`, name:'Custom', w,h,mines}); setShowCustom(false); }}>Start</button> </div>} </div> <div className="msw-grid-wrap"> <div className="msw-grid" style={{gridTemplateColumns:`repeat(${grid[0].length}, 28px)`}} role="grid" aria-label="Minesweeper board"> {grid.map((row,y)=> row.map((cell,x)=>{ const key=`${x}-${y}`; const classes=['msw-cell']; if(cell.v) classes.push('revealed'); if(cell.f) classes.push('flag'); if(cell.x) classes.push('exploded'); if(cell.v && !cell.m && cell.r>0) classes.push(`n${cell.r}`); const isRecent=recent.has(key); if(isRecent) classes.push('wave'); const d=origin?(Math.abs(x-origin.x)+Math.abs(y-origin.y)):0; return <button key={key} className={classes.join(' ')} style={{['--d']:d}} onClick={e=>onCellClick(e,x,y)} onContextMenu={e=>onCellRight(e,x,y)} onDoubleClick={e=>onCellDouble(e,x,y)} aria-label={!cell.v?(cell.f?'Flagged':'Hidden'):(cell.m?'Mine':`${cell.r||0}`)} disabled={over&&!cell.v}>{cell.v?(cell.m?'💣':(cell.r||'')):(cell.f?'🚩':'')}</button>; }))} </div> </div> {over && !won && <div className="msw-status lose" role="alert">Boom! Try again.</div>} {won && <div className="msw-status win" role="alert">Cleared! Congrats.</div>} <div className="msw-help">Tip: Right-click to flag, double-click numbers to chord. On touch, toggle Flag Mode.</div> </div>);
                }

                                // Web of Life (SVG radial graph) — polished, professional layout
                                function WebOfLife() {
                                    const center = { x: 300, y: 200 };
                                    const items = [
                                        { id: 'cv', label: 'CV', action: () => window.open('Diego_Resume.pdf','_blank') },
                                        { id: 'projects', label: 'Projects', action: () => scrollToId('projects') },
                                        { id: 'experience', label: 'Experience', action: () => scrollToId('experience') },
                                        { id: 'skills', label: 'Skills', action: () => scrollToId('skills') },
                                        { id: 'education', label: 'Education', action: () => scrollToId('education') },
                                        { id: 'contact', label: 'Contact', action: () => scrollToId('contact') }
                                    ];
                                    const [active, setActive] = React.useState(null);

                                    function scrollToId(id) {
                                        const el = document.getElementById(id);
                                        if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                    }

                                    // compute radial positions (two rings)
                                    const ring1 = 150, ring2 = 210;
                                    const positions = items.map((it, i) => {
                                        const ring = i < 3 ? ring1 : ring2;
                                        const idx = i < 3 ? i : i - 3;
                                        const count = i < 3 ? 3 : (items.length - 3);
                                        const angle = (Math.PI * 2 * (idx / count)) + (i < 3 ? -Math.PI/6 : Math.PI/6);
                                        return { ...it, x: center.x + ring * Math.cos(angle), y: center.y + ring * Math.sin(angle) };
                                    });

                                    return (
                                        <div className="wol2">
                                            <svg className="wol2-svg" viewBox="0 0 600 420" role="img" aria-label="Interactive map of Diego's work">
                                                <defs>
                                                    <filter id="ds"><feDropShadow dx="0" dy="4" stdDeviation="6" flood-color="#000" flood-opacity="0.25"/></filter>
                                                    <linearGradient id="cg" x1="0%" y1="0%" x2="100%" y2="100%">
                                                        <stop offset="0%" stopColor="var(--primary)"/>
                                                        <stop offset="100%" stopColor="var(--secondary)"/>
                                                    </linearGradient>
                                                </defs>
                                                {/* rings */}
                                                <circle cx={center.x} cy={center.y} r={ring1} className="wol2-ring" aria-hidden="true" />
                                                <circle cx={center.x} cy={center.y} r={ring2} className="wol2-ring" aria-hidden="true" />
                                                {/* links */}
                                                {positions.map(p => (
                                                    <line key={'l-'+p.id} x1={center.x} y1={center.y} x2={p.x} y2={p.y} className={`wol2-link ${active===p.id?'active':''}`} aria-hidden="true" />
                                                ))}
                                                {/* center node */}
                                                <g className="wol2-center" transform={`translate(${center.x},${center.y})`}>
                                                    <circle r="36" fill="url(#cg)" />
                                                    <text textAnchor="middle" dominantBaseline="middle" className="wol2-center-text">Diego</text>
                                                </g>
                                                {/* nodes */}
                                                                                                {positions.map(p => (
                                                                                                        <g key={p.id}
                                                         className={`wol2-node ${active===p.id?'active':''}`}
                                                         transform={`translate(${p.x},${p.y})`}
                                                         onMouseEnter={() => setActive(p.id)}
                                                         onMouseLeave={() => setActive(null)}
                                                         onFocus={() => setActive(p.id)}
                                                         onBlur={() => setActive(null)}
                                                         onClick={() => { setActive(null); p.action(); }}
                                                         role="button" tabIndex={0}
                                                         onKeyDown={(e)=>{ if(e.key==='Enter'||e.key===' ') { e.preventDefault(); setActive(null); p.action(); } }}>
                                                        <title>{p.label}</title>
                                                        <circle r="20" />
                                                        <text y="36" textAnchor="middle" className="wol2-label">{p.label}</text>
                                                    </g>
                                                ))}
                                            </svg>
                                        </div>
                                    );
                                }

                // The main App component. Assembles all sections and the navigation bar.
                function App() {
                        // Initialize dark mode from localStorage or system preference
                        const prefers = typeof window !== 'undefined' && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                        const storedPref = typeof window !== 'undefined' ? window.localStorage.getItem('darkMode') : null;
                        const initialDark = storedPref === null ? prefers : storedPref === 'true';
                        const [darkMode, setDarkMode] = React.useState(initialDark);
                        React.useEffect(() => {
                            const root = document.documentElement; // <html>
                            if (darkMode) root.classList.add('dark-mode'); else root.classList.remove('dark-mode');
                            window.localStorage.setItem('darkMode', darkMode ? 'true' : 'false');
                        }, [darkMode]);
                        const toggleDarkMode = () => setDarkMode(d => !d);
                        // Track active section for nav highlight
                        const [currentSection, setCurrentSection] = React.useState('home');
                        React.useEffect(() => {
                            const sections = Array.from(document.querySelectorAll('.section'));
                            const obs = new IntersectionObserver((entries) => {
                                entries.forEach(e => { if (e.isIntersecting && e.target.id) setCurrentSection(e.target.id); });
                            }, { rootMargin: '-45% 0px -45% 0px', threshold: [0, 0.25, 0.5, 0.75, 1] });
                            sections.forEach(s => obs.observe(s));
                            return () => obs.disconnect();
                        }, []);

                        // State for the chatbot open/closed status and chat messages
            const [chatOpen, setChatOpen] = React.useState(false);
            const [chatInput, setChatInput] = React.useState('');
            const [messages, setMessages] = React.useState([
                { from: 'bot', text: 'Hello! I\'m your personal assistant. How can I help you?' }
            ]);

                        // Resolve chat base for health checks and requests
                        const getChatBase = React.useCallback(() => {
                            const configured = (window.CHAT_API_BASE || '').trim();
                            return (configured || (location.hostname === 'localhost' ? 'http://localhost:8787' : '')).replace(/\/$/, '');
                        }, []);
                        const { healthy: chatHealthy, check: checkChatHealth } = useChatHealth(getChatBase);

            // Assistant handled by assistantEngine (see assistant.js)
            

            // Handle sending a chat message. This helper is invoked when the user
            // presses Enter or clicks the Send button. It appends the user’s
            // message to the chat, clears the input, calls getAIReply() and
            // appends the bot’s response.
            const handleChatSend = async () => {
                if (chatInput.trim() !== '') {
                    const input = chatInput.trim();
                    // Add the user’s message to the log
                    setMessages(prev => [...prev, { from: 'user', text: input }]);
                    setChatInput('');
                    // Fetch AI reply
                    const reply = await assistantEngine.ask(input);
                    setMessages(prev => [...prev, { from: 'bot', text: reply }]);
                }
            };

            // Handle Enter key by delegating to handleChatSend()
            const handleChatKeyPress = (e) => {
                if (e.key === 'Enter') {
                    handleChatSend();
                }
            };

            return (
                <div>
                    <NavBar darkMode={darkMode} toggleDarkMode={toggleDarkMode} currentSection={currentSection} />
                    {/* Home section with a hero message */}
                    <Section id="home" title="">
                        <div className="hero hero-intro">
                            <h1 className="intro-name" aria-label="Diego Crisafulli">
                                <span className="intro-first">Diego</span>
                                <span className="intro-last">Crisafulli</span>
                            </h1>
                            <p className="intro-typing" aria-live="polite"><span id="typewriter"></span><span className="cursor">|</span></p>
                            <div className="intro-sub">
                                <p>Crafting cloud‑native solutions, web experiences, and immersive simulations.</p>
                            </div>
                            <div className="intro-game">
                                <GameHero />
                            </div>
                            <div className="intro-cta">
                                <a href="Diego_Resume.pdf" className="button download‑btn" download>Download Resume</a>
                            </div>
                        </div>
                    </Section>
                    {/* Challenge game section (Minesweeper) */}
                    <Section id="challenge" title="Challenge: Minesweeper">
                        <GameMinesweeper />
                    </Section>
                    {/* Web of Life section */}
                    <Section id="web-of-life" title="Web of Life">
                        <p style={{marginTop:0}}>Hover or tap nodes to explore my work and background.</p>
                        <WebOfLife />
                    </Section>
                    {/* About section describing Diego’s professional summary */}
                    <Section id="about" title="About">
                        <p>
                            I'm a multidisciplinary software engineer specializing in DevOps, full‑stack web development and
                            cloud automation. Over the past few years I've streamlined deployments, enhanced system
                            reliability and delivered AI‑driven solutions. I'm passionate about leveraging cutting‑edge
                            technologies to solve complex problems and love tackling new challenges.
                        </p>
                    </Section>
                    {/* Skills section listing grouped skills */}
                    <Section id="skills" title="Skills">
                        <ul className="skills‑list">
                            <li><strong>Cloud & DevOps:</strong> Azure, AWS (EC2, S3, Lambda), GitHub Actions, CI/CD, Infrastructure as Code</li>
                            <li><strong>Programming & Web:</strong> JavaScript, TypeScript, PowerShell, Python, C++, HTML5, CSS3</li>
                            <li><strong>Databases:</strong> MongoDB, SQL</li>
                            <li><strong>AI & Automation:</strong> OpenAI API, Generative AI, Prompt Engineering, Test Automation</li>
                            <li><strong>3D & Simulation:</strong> Unreal Engine, NVIDIA Omniverse, VR/AR Development</li>
                            <li><strong>Tools:</strong> Git, GitHub Copilot, Docker, SCTP, TLS, DPDK/VPP</li>
                        </ul>
                    </Section>
                    {/* Experience section summarizing career roles */}
                    <Section id="experience" title="Experience">
                        <div className="experience">
                            <div className="job">
                                <h3>Software Engineer (DevOps) – CAE</h3>
                                <span className="job‑date">May 2025 – Present</span>
                                <ul>
                                    <li>Developed and maintained automation pipelines with Azure and GitHub Actions, boosting deployment efficiency by 30%.</li>
                                    <li>Partnered with cross‑functional teams to optimize asset flow, reducing system downtime by 25%.</li>
                                    <li>Engineered cloud computing solutions using JavaScript and PowerShell, improving overall system reliability and scalability.</li>
                                </ul>
                            </div>
                            <div className="job">
                                <h3>IVR System Developer – CAE</h3>
                                <span className="job‑date">Sep 2024 – May 2025</span>
                                <ul>
                                    <li>Proposed continual improvements to IVR functionality and user experience, driving measurable gains in customer satisfaction.</li>
                                    <li>Developed and optimized automated test scripts (JavaScript, XML, JSON), boosting testing coverage and reducing defects.</li>
                                    <li>Analyzed test outcomes, identified root causes and collaborated with cross‑functional teams to enhance system reliability.</li>
                                </ul>
                            </div>
                            <div className="job">
                                <h3>Software Engineer Intern – CAE</h3>
                                <span className="job‑date">Oct 2023 – Sep 2024</span>
                                <ul>
                                    <li>Contributed to the Ondulus IR team, developing and testing advanced simulation technologies including night vision, LiDAR and infrared systems.</li>
                                    <li>Led C++ sensor testing processes and optimized algorithms to automate testing workflows.</li>
                                    <li>Created comprehensive test cases to validate physics‑based simulation modules under diverse conditions.</li>
                                </ul>
                            </div>
                            <div className="job">
                                <h3>Simulation Developer – Presagis</h3>
                                <span className="job‑date">Jun 2022 – Jun 2023</span>
                                <ul>
                                    <li>Coded simulations using NVIDIA Omniverse Isaac Sim, implementing machine‑learning, point‑cloud and lidar technology for AI solutions.</li>
                                    <li>Integrated USD workflows into Velocity5D and created digital twins with 3D modelling, texturing and mapping.</li>
                                    <li>Collaborated with developers and 3D artists; utilized Python for automation and tool development.</li>
                                </ul>
                            </div>
                            <div className="job">
                                <h3>3D Artist/Developer – Presagis</h3>
                                <span className="job‑date">Sep 2021 – Jun 2022</span>
                                <ul>
                                    <li>Built a library of custom 3D models, textures and animations using Unreal Engine, Omniverse and Blender.</li>
                                    <li>Employed Python scripting to streamline asset creation and optimize 3D workflows.</li>
                                    <li>Collaborated with cross‑functional teams to deliver visually engaging simulation assets.</li>
                                </ul>
                            </div>
                        </div>
                    </Section>
                    {/* Projects section highlighting major projects */}
                    <Section id="projects" title="Projects">
                        <div className="projects">
                            <div className="project">
                                <h3>VR Brain Installation</h3>
                                <p>
                                    Lead VR/AI Developer working with McGill University’s neuroscience team to translate authentic neural imaging data into an immersive VR experience. Built AI‑powered pipelines and optimized 3D environments in Unreal Engine for high‑fidelity visualization.
                                </p>
                            </div>
                            <div className="project">
                                <h3>The Actual Informer</h3>
                                <p>
                                    Full‑stack news summarization web app built with TypeScript, Node.js and Express, deployed on AWS. Integrated OpenAI’s API to rewrite and shorten articles, improving readability and engagement. Designed a responsive user interface with HTML5 and CSS3.
                                </p>
                            </div>
                        </div>
                        {/* Featured projects: highlight portfolio additions */}
                        <div className="featured-projects">
                            <div className="project-card">
                                <h3>Real-Time Dashboard</h3>
                                <p>
                                    A Python Dash application that streams and visualizes data in real time. Includes a data source selector
                                    and update-interval slider. View the code on
                                    {' '}
                                    <a href="https://github.com/diegocrisafu/realtime-dashboard" target="_blank" rel="noopener noreferrer">GitHub</a>.
                                </p>
                            </div>
                            <div className="project-card">
                                <h3>Expense Tracker</h3>
                                <p>
                                    A React-based expense tracker app with local persistence, deletion and a category pie chart. Open it directly
                                    via its <a href="https://diegocrisafu.github.io/expense/" target="_blank" rel="noopener noreferrer">live page</a> once
                                    GitHub Pages is enabled, or see the code on{' '}
                                    <a href="https://github.com/diegocrisafu/expense" target="_blank" rel="noopener noreferrer">GitHub</a>.
                                </p>
                            </div>
                        </div>
                    </Section>
                    {/* Education section listing academic background */}
                    <Section id="education" title="Education">
                        <div className="education">
                            <div className="school">
                                <h3>Concordia University</h3>
                                <span className="school‑date">2022 – Present</span>
                                <p>Double Major in Computational Design & Computer Science. Engaged in projects spanning 3D graphics, high‑performance computing and AI development.</p>
                            </div>
                            <div className="school">
                                <h3>Marianopolis College</h3>
                                <span className="school‑date">2020 – 2022</span>
                                <p>DEC in Commerce. Strengthened critical thinking and methodology skills with a focus on business and information systems.</p>
                            </div>
                        </div>
                    </Section>
                    {/* Contact section with simple contact info and call‑to‑action */}
                    <Section id="contact" title="Contact">
                        <p>
                            Feel free to reach out via email at <a href="mailto:diego.crisafu@gmail.com">diego.crisafu@gmail.com</a> or connect with me on <a href="https://www.linkedin.com/in/diegocrisafulli212bb0256" target="_blank" rel="noopener noreferrer">LinkedIn</a>.
                        </p>
                    </Section>
                    <footer className="footer">© {new Date().getFullYear()} Diego Crisafulli</footer>
                    {/* Floating chatbot component */}
                    <div className="chatbot-container">
                        {/* Chat icon toggles the chat window on click */}
                        <div
                            className="chat-icon"
                            role="button"
                            aria-label={chatOpen ? 'Close chat' : 'Open chat'}
                            tabIndex="0"
                            onClick={() => setChatOpen(!chatOpen)}
                        >
                            💬
                        </div>
                        {chatOpen && (
                            <div className="chat-window">
                                {/* Header with title, close and clear buttons */}
                                                                <div className="chat-window-header">
                                                                        <h4>
                                                                            <span className={`chat-status-dot ${chatHealthy ? 'online' : 'offline'}`} title={chatHealthy ? 'Online' : 'Offline'}></span>
                                                                            Assistant <span style={{fontSize:'0.7em',opacity:0.7}}>{localStorage.getItem('forceLocalChat')==='1'?'(local)':''}</span>
                                                                        </h4>
                                    <div className="chat-window-controls">
                                        <button
                                            className="chat-clear-btn"
                                            aria-label="Clear conversation"
                                            onClick={() =>
                                                setMessages([
                                                    {
                                                        from: 'bot',
                                                        text: "Hello! I'm your personal assistant. How can I help you?",
                                                    },
                                                ])
                                            }
                                        >
                                            Clear
                                        </button>
                                                                                <button className="chat-clear-btn" onClick={() => checkChatHealth()} aria-label="Retry health check">Check</button>
                                        <button
                                            className="chat-close-btn"
                                            aria-label="Close chat window"
                                            onClick={() => setChatOpen(false)}
                                        >
                                            \u00d7
                                        </button>
                                    </div>
                                </div>
                                <div className="chat-messages">
                                    {messages.map((msg, idx) => (
                                        <div key={idx} className={`chat-message ${msg.from}`}>{msg.text}</div>
                                    ))}
                                </div>
                                {/* Input area with send button */}
                                <div className="chat-input-container">
                                    <input
                                        type="text"
                                        className="chat-input"
                                        placeholder="Type a message..."
                                        value={chatInput}
                                        onChange={(e) => setChatInput(e.target.value)}
                                        onKeyPress={handleChatKeyPress}
                                    />
                                    <button className="chat-send-btn" onClick={handleChatSend}>Send</button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

                // Chat health util inside App scope
                function useChatHealth(getBase) {
                    const [healthy, setHealthy] = React.useState(false);
                    const check = React.useCallback(async () => {
                        try {
                            const base = getBase();
                            if (!base) { setHealthy(false); return false; }
                            // try /health (node) first, then root (worker)
                            let ok = false;
                            try {
                                const r1 = await fetch(`${base}/health`, { method: 'GET' });
                                ok = r1.ok;
                                if (!ok) throw new Error('health not ok');
                            } catch {
                                const r2 = await fetch(base, { method: 'GET' });
                                ok = r2.ok;
                            }
                            setHealthy(!!ok);
                            return ok;
                        } catch {
                            setHealthy(false);
                            return false;
                        }
                    }, [getBase]);
                    // poll every 30s
                    React.useEffect(() => {
                        check();
                        const id = setInterval(check, 30000);
                        return () => clearInterval(id);
                    }, [check]);
                    return { healthy, check };
                }

                // Render the App component into the root div
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <script>
            // Register service worker for basic offline support
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('./sw.js').catch(() => {});
                });
            }
        </script>
    <script>
            // Lightweight typewriter for the intro subtitle
            (function(){
                const phrases = [
                    'Software & ML Engineer',
                    'Cloud‑native builder',
                    'Full‑stack developer'
                ];
                let i = 0, j = 0, erasing = false;
                const el = () => document.getElementById('typewriter');
                function tick(){
                    const target = el(); if(!target) return;
                    const p = phrases[i % phrases.length];
                    if(!erasing){ j++; target.textContent = p.slice(0, j); if(j >= p.length){ erasing = true; setTimeout(tick, 1200); return; } }
                    else { j--; target.textContent = p.slice(0, j); if(j <= 0){ erasing = false; i++; } }
                    setTimeout(tick, erasing ? 40 : 70);
                }
                window.addEventListener('DOMContentLoaded', () => setTimeout(tick, 400));
            })();
        </script>
    
</body>
</html>